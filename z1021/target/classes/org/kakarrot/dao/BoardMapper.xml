<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  
<mapper namespace="org.kakarrot.dao.BoardMapper">

<resultMap type="org.kakarrot.domain.BoardVO" id="selectOneResult">
	<id property="pno" />
	<result property="title" column="title"/>
	<result property="content" column="content"/>
	<result property="wireter" column="wireter"/>
	<collection property="fnames" ofType="String"></collection>
</resultMap>

<select id="selectOne" resultMap="selectOneResult">
      select *
      from
      tbl_board_sample board left outer join tbl_uploadfile attach
      on board.bno = attach.board_no
      where []no = #{pno}

</select>

<insert id="insertOne" >
insert into tbl_board_sample 
values(#{pno}
,#{title},#{writer},#{content},0,sysdate,sysdate )
</insert>

<select id="selectList" resultType="org.kakarrot.domain.BoardVO">
<![CDATA[
select * from
(select rownum rn,tb.* from 
(select * from tbl_board_sample order by pno desc) tb 
where rownum <= #{amount}*#{page})
where rn >=(#{page}-1)*#{amount}]]>
</select>

<select id="getCount" resultType="Integer">
<![CDATA[
select count(*) from tbl_board_sample
]]>
</select>

<update id="update">
	UPDATE tbml_board_sample
	SET view_count = #{view_count}, tilte = #{tilte}, writer = #{writer},content = #{content}, updatedate = sysdate
	where pno = #{pno}

</update>
<delete id="delete">
	delete tbl_board_sample where pno =#{pno}
</delete>

<select id="total" resultType="int">
select count(pno) from tbml_board_sample; 
</select>

  
  <select id="nextval" resultType="int">
select seq_board_sample.nextval from dual
</select>
  
  <insert id="insertfile" >
	insert into tbl_uploadfile 	values(#{board_no}	,#{f_name})
</insert>

<update id="updateViewCnt">
update tbl_board_sample set view_count = view_count+1 
where pno = #{pno} 
</update>
  
</mapper>